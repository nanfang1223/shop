{"version":3,"sources":["uni-app:///main.js","webpack:///F:/ss/pages/order/order_payment.vue?c431","webpack:///F:/ss/pages/order/order_payment.vue?357e","webpack:///F:/ss/pages/order/order_payment.vue?2805","webpack:///F:/ss/pages/order/order_payment.vue?a948","uni-app:///pages/order/order_payment.vue"],"names":["createPage","Page"],"mappings":"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","file":"pages/order/order_payment.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/order/order_payment.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./order_payment.vue?vue&type=template&id=038977aa&scoped=true&\"\nvar renderjs\nimport script from \"./order_payment.vue?vue&type=script&lang=js&\"\nexport * from \"./order_payment.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"038977aa\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/order/order_payment.vue\"\nexport default component.exports","export * from \"-!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order_payment.vue?vue&type=template&id=038977aa&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order_payment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../BaiduNetdiskDownload/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order_payment.vue?vue&type=script&lang=js&\"","<template>\r\n    <view class=\"order_payment\">\r\n        <heads return-r=\"5\" :title=\"language.order.order_pay.title\"></heads>\r\n\r\n        <paymodel @cancel=\"wallet_pay_cancel\" @success=\"check_pay_password\" v-model=\"pay_display\"/>\r\n\r\n        <choose-pay\r\n            :aliPayStatue=\"aliPayStatue\"\r\n            :baidupayStatue=\"baidupayStatue\"\r\n            :open_alipay=\"open_alipay\"\r\n            :open_baidu=\"open_baidu\"\r\n            :open_wallet=\"open_wallet\"\r\n            :open_wxpay=\"open_wxpay\"\r\n            :useWallet=\"useWallet\"\r\n            :user_money=\"user_money\"\r\n            :wxPayStatue=\"wxPayStatue\"\r\n            @chooseWay=\"chooseWay($event)\"\r\n        />\r\n\r\n        <submit-order\r\n            :ishide=\"0\"\r\n            :total=\"total\"\r\n            @submit=\"order_pay()\"\r\n        />\r\n    </view>\r\n</template>\r\n<script>\r\n    import paymodel from '@/components/paymodel.vue'\r\n    import choosePay from '@/components/choose-pay.vue'\r\n    import submitOrder from '@/components/order/submit-order.vue'\r\n    import mixinsPay from '../../mixins/pay'\r\n    import mixinsOrder from '../../mixins/order'\r\n    import { later } from '@/common/util'\r\n\r\n    export default {\r\n        data () {\r\n            return {\r\n                tmplIds: ['2KrrJchj92YRKhZZ0SSHz76dmrT0cLBJ2Wfe0', 'ncs3u3Bmmi0jW7EXAik4KQvxF3JxbaulWNwbLXDto', 'CZAPo_TqOOeC5K7XYvBeB_LXmyXKIhXkZROArNZDwQ8'],//微信订阅消息模板\r\n                ordertype: ''\r\n            }\r\n        },\r\n        mixins: [mixinsPay, mixinsOrder],\r\n        components: { paymodel, choosePay, submitOrder },\r\n        onLoad (option) {\r\n            this.ordertype = option.ordertype\r\n            this.getCode()\r\n            this.order_id = option.order_id\r\n            if (option.showPay) {\r\n                this.showPay = true\r\n            }\r\n            this.checkCode()\r\n            this._axios()\r\n        },\r\n        onUnload () {\r\n            // #ifdef H5\r\n            if (location.hostname === 'localhost') return false;\r\n            setTimeout(() => {\r\n\r\n                let state = window.location.href.replace(/\\?code=.*?\\//, '#/')\r\n                // console.log(state);\r\n                history.replaceState(null, null, state)\r\n            }, 300)\r\n            // #endif\r\n\r\n        },\r\n        methods: {\r\n            /**\r\n             * 支付失败\r\n             * @private\r\n             */\r\n            _pay_fail () {\r\n                uni.showModal({\r\n                    title: this.language.showModal.hint,\r\n                    content: this.language.showModal.payFail,\r\n                    confirmText: this.language.showModal.confirm,\r\n                    cancelText: this.language.showModal.cancel,\r\n                    success: res => {\r\n                        this.fastTap = false\r\n                        if (res.confirm) {\r\n                            this.status(1);\r\n                            let url = '/pages/order/myOrder?status=1'\r\n                            if (this.ordertype === 'pt') {\r\n                                url = '/pagesA/group/groupOrder?status=1'\r\n                            }\r\n                            \r\n                            uni.redirectTo({\r\n                                url\r\n                            })\r\n                        } else if (res.cancel) {\r\n                            uni.switchTab({\r\n                                url: '/pages/tabBar/home'\r\n                            })\r\n                        }\r\n                    }\r\n                })\r\n            },\r\n            /**\r\n             * 点击立即支付按钮触发\r\n             * @returns {Promise<boolean>}\r\n             */\r\n            async order_pay () {\r\n                if (this.fastTap) return false\r\n                this.fastTap = true\r\n                \r\n                if (this.showPay) {\r\n                    try {\r\n                        await this._check_order_status();\r\n                    } catch(e) {\r\n                        uni.showToast({\r\n                            title: e,\r\n                            icon: 'none'\r\n                        })\r\n                        this.fastTap = false\r\n                        return false;\r\n                    }\r\n                }\r\n                \r\n                this._checkSelectPayWay()\r\n\r\n                // #ifdef MP-WEIXIN\r\n                uni.showLoading({\r\n                    title: this.language.order.order_pay.Tips[0]\r\n                })\r\n                wx.requestSubscribeMessage({\r\n                    tmplIds: this.tmplIds,\r\n                    complete:async () => {\r\n                        uni.hideLoading()\r\n                        if (this.useWallet) {\r\n                            if (!this.sNo) {\r\n                                await this._getPayOrderInfo()\r\n                            }\r\n                            this._orderUseWalletPay()\r\n                        } else {\r\n                            uni.showLoading({\r\n                                title: this.language.order.order_pay.Tips[1],\r\n                                mask: true,\r\n                            })\r\n                            this._notUserWalletPay()\r\n                        }\r\n                    }\r\n                })\r\n                // #endif\r\n\r\n                // #ifndef MP-WEIXIN\r\n                if (this.useWallet) {\r\n                    if (!this.sNo) {\r\n                        await this._getPayOrderInfo()\r\n                    }\r\n                    this._orderUseWalletPay()\r\n                } else {\r\n                    uni.showLoading({\r\n                        title: this.language.order.order_pay.Tips[1],\r\n                        mask: true,\r\n                    })\r\n                    this._notUserWalletPay()\r\n                }\r\n                // #endif\r\n\r\n            },\r\n            /**\r\n             * 取得调用支付的所需订单信息\r\n             * @param pay_type\r\n             * @returns {Promise<*>}\r\n             */\r\n            async getPaymentData () {\r\n                let data = {\r\n                    module: 'app',\r\n                    action: 'pay',\r\n                    total: this.total,\r\n                    sNo: this.sNo,\r\n                    title: this.payTitle\r\n                }\r\n\r\n                let { type, code, store_type } = await this.getOrderInfoExt()\r\n                data.type = type\r\n                data.code = code\r\n                data.store_type = store_type\r\n\r\n                let auth_code = await this.LaiKeTuiCommon.getMPAliAuthCode()\r\n                if (auth_code) {\r\n                    // #ifdef MP-ALIPAY\r\n                    data.alimp_authcode = auth_code\r\n                    // #endif\r\n                    // #ifdef MP-TOUTIAO\r\n                    data.tt_authcode = auth_code\r\n                    // #endif\r\n                }\r\n\r\n                return await this.$req.post({ data })\r\n            },\r\n            /**\r\n             * 余额支付\r\n             * @returns {Promise<void>}\r\n             * @private\r\n             */\r\n            async _wallet_pay () {\r\n                let postData = {\r\n                    module: 'app',\r\n                    action: 'pay',\r\n                    app: 'wallet_pay',\r\n                    m: 'wallet_pay',\r\n                    type: 'wallet_pay',\r\n                    order_id: this.order_id,\r\n                    sNo: this.sNo,\r\n                    parameter: 'order',\r\n                    payment_money: this.total\r\n                }\r\n                let res = await this.$req.post({ data: postData })\r\n                let { code } = res\r\n                uni.hideLoading()\r\n                if (code === 0) {\r\n                    uni.showToast({\r\n                        title: res.err,\r\n                        duration: 1000,\r\n                        icon: 'none'\r\n                    })\r\n                    return false;\r\n                }\r\n\r\n                uni.showToast({\r\n                    title: this.language.order.order_pay.Tips[2],\r\n                    duration: 1000,\r\n                    icon: 'none'\r\n                })\r\n                await later(1000)\r\n                uni.setStorageSync('payRes', this.order_pay_info)\r\n                uni.redirectTo({\r\n                    url: '/pages/pay/payResult'\r\n                })\r\n            },\r\n            _axios () {\r\n                let action = 'order'\r\n                if (this.ordertype === 'pt') {\r\n                    action = 'groupbuy' \r\n                } else if (this.ordertype === 'KJ') {\r\n                    action = 'bargain'\r\n                }\r\n                \r\n                let data = {\r\n                    order_id: this.order_id,\r\n                    module: 'app',\r\n                    action,\r\n                    app: 'order_details',\r\n                    m: 'order_details' // 兼容普通订单和插件订单写法\r\n                }\r\n                \r\n                \r\n                this.$req.post({ data }).then(res => {\r\n                    let {\r\n                        data: {\r\n                            z_price: total,\r\n                            payment,\r\n                            user_money,\r\n                            sNo,\r\n                            list\r\n                        }\r\n                    } = res\r\n                    this.total = total\r\n                    this.payment = payment\r\n                    this.user_money = Number.parseFloat(user_money)\r\n                    this.sNo = sNo\r\n                    this.payTitle = list[0].p_name\r\n                    this.show_pay_way()\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n"],"sourceRoot":""}