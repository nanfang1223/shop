(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabBar/shoppingCart"],{"0e81":function(t,i,e){"use strict";var s=e("c329"),a=e.n(s);a.a},"516b":function(t,i,e){"use strict";(function(t){e("1fd4");s(e("66fd"));var i=s(e("c3b0"));function s(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},"86c7":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=e("2f62");function a(t){return h(t)||o(t)||n(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(t,i){if(t){if("string"===typeof t)return l(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,i):void 0}}function o(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function h(t){if(Array.isArray(t))return l(t)}function l(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,s=new Array(i);e<i;e++)s[e]=t[e];return s}function c(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,s)}return e}function u(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?c(Object(e),!0).forEach((function(i){d(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):c(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}function d(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var g=function(){e.e("components/skus").then(function(){return resolve(e("6910"))}.bind(null,e)).catch(e.oe)},p={data:function(){return{is_grade:!1,numb:1,access_id1:!1,nrlflag:!1,shopImg:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon1/allgoods_shopImg.png",closeImg:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/guanbi2x.png",loadGif:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/loading.gif",kong:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/shopping3x.png",jianX:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/jianX.png",jiantou2x:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/jiantou2x.png",store:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/store.png",bottom:3,quan_hui:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/xuanzehui2x.png",quan_hei:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/94661f89895ca9ab42b080e14c49c56.png",jian_hui:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/jianhui2x.png",jian_hei:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/jian2x.png",jia_hei:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/jia+2x.png",jia_hui:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/add+2x.png",manage:!0,manage_text:"编辑",manage_pay:"去结算",content:"确认删除选中的商品吗？",mask_value:"",display:!1,display_img1:[],display_img:[],selectArray:[],selectStore:[],selectStoreArray:[],storeArray:[],goods:[],selectAll:!1,load:!1,mask_display:!1,mask_display1:!1,attribute_id:"",attrList:"",skuBeanList:"",num:"",price:"",imgurl:"",haveSkuBean:"",shopping_id:"",jia_img:[],list:[],mch_list:[],fastTap:!0,highKeys:{},skuName:"SkuID",skuName1:"Price",skuName2:"Pic",skuName3:"Stock",spliter:",",sku_list:{},result:{},tj_page:1,loadingType:0,changeAttrNum:0}},components:{skus:g},onLoad:function(){t.setStorageSync("jz",1);var i=t.getStorageSync("needRegister");this.nrlflag=i==this.LaiKeTuiCommon.LKT_NRL_TYPE.NRL},onTabItemTap:function(t){this.LaiKeTuiCommon.closeMPAuthWin(this)},onShow:function(){this.tj_page=1,t.showTabBar(),this.display=!1,this.LaiKeTuiCommon.getUrlFirst(this._axios);var i=t.getStorageSync("needRegister");this.nrlflag=i==this.LaiKeTuiCommon.LKT_NRL_TYPE.NRL;for(var e=0;e<this.goods.length;e++)this.display_img[e]=!1;this.selectArray=[];for(e=0;e<this.mch_list.length;e++)this.display_img1[e]=!1;this.selectStore=[],this.manage_text="编辑",this.manage_pay="去结算",this.selectAll=!1,this.manage=!0,t.setNavigationBarTitle({title:this.language.shoppingCart.title})},onReachBottom:function(){0==this.loadingType&&(this.loadingType=1,this.tj_page++,this._axios())},methods:u(u({toStore:function(i){t.navigateTo({url:"/pagesA/store/store?shop_id="+i})},changeLoginStatus:function(){this._axios()},_shopping:function(i){var e=this;if(this.haveSkuBean){var s={module:"app",action:"product",app:"add_cart",pro_id:this.proid,attribute_id:this.haveSkuBean.cid,num:this.numb,type:"addcart"};this.$req.post({data:s}).then((function(i){var s=i.code,a=i.data,r=i.message;200==s?(t.showToast({title:e.language.shoppingCart.addSuc,icon:"none"}),e.$store.state.access_id=a.access_id,e.haveSkuBean="",e.$refs.attrModal._mask_f(),setTimeout((function(){e.fastTap=!0,e.tj_page=1,e._axios()}),500)):(t.showToast({title:r,icon:"none"}),e.fastTap=!0)})).catch((function(t){e.fastTap=!0}))}else this.fastTap=!0},shopping_j:function(i,e){var s=this;if(3!=e.status)if(0!=e.num){if(this.fastTap){this.fastTap=!1,this.proid=i;var a={module:"app",action:"product",app:"index",pro_id:i};this.$req.post({data:a}).then((function(t){s.fastTap=!0;var i=t.data,e=(i.collection_id,i.pro),a=(i.comments,i.attrList),r=(i.skuBeanList,i.attribute_list),n=i.qj_price,o=i.type;s.ys_price=n,s.attrList=a,s.$refs.attrModal.imgurl=e.img_arr[0],s.$refs.attrModal.num=e.num,s.$refs.attrModal.price=n,s.$refs.attrModal.skuBeanList=r,s.$refs.attrModal.initData(),s.$refs.attrModal._mask_display(),s.collection=o})).catch((function(t){s.fastTap=!0}))}}else t.showToast({title:this.language.shoppingCart.soldOut1,icon:"none"});else t.showToast({title:this.language.shoppingCart.proDown,icon:"none"})},_goods:function(i){this.$store.commit("SET_PRO_ID",i),t.navigateTo({url:"/pages/goods/goodsDetailed?toback=true&pro_id="+i})},toLogin:function(){t.navigateTo({url:"/pages/login/login?landing_code=1"})},toHome:function(){t.switchTab({url:"/pages/tabBar/home"})},_mask_display:function(t,i,e,s,a,r){var n=this;this.shopping_id=s,this.changeAttrNum=r;var o={module:"app",action:"cart",app:"dj_attribute",pro_id:s};this.access_id,o.cart_id=s,this.imgurl=e,this.$req.post({data:o}).then((function(t){var i=t.data;n.attrList=i[0].attrList,n.$refs.attrModal1.skuBeanList=i[0].attribute_list,n.$refs.attrModal1.initData(!0),n.$refs.attrModal1._mask_display();var e=n.$refs.attrModal1.sku_list;for(var s in e.items)e.items[s].sku==a&&(n.$refs.attrModal1.haveSkuBean={name:e.items[s].path,cid:a,skus:e.items[s]});var r=n.$refs.attrModal1.haveSkuBean.name.split(",");for(var o in e.result){var h=function(t){var i=r.some((function(i){return i==t}));i&&n.$refs.attrModal1.handleActive(o,e.result[o][t])};for(var l in e.result[o])h(l)}}))},_confirm:function(t){Object.assign(this.$data,t),this._confirm1()},_confirm1:function(){this.fastTap&&(this.fastTap=!1,Boolean(this.haveSkuBean)?0==this.num?(t.showToast({title:this.language.shoppingCart.kucunTips,duration:1e3,icon:"none"}),this.fastTap=!0):0!=this.num&&this._shopping():0==this.num?(t.showToast({title:this.language.shoppingCart.kucunTips,duration:1e3,icon:"none"}),this.fastTap=!0):(t.showToast({title:this.language.shoppingCart.chooseAttrTips,duration:1e3,icon:"none"}),this.fastTap=!0))},_confirm11:function(i){var e=this;if(Object.assign(this.$data,i),Boolean(this.haveSkuBean)){var s=this.haveSkuBean.skus.Stock;if(this.changeAttrNum>s)return void t.showToast({title:this.language.shoppingCart.kucunTips,icon:"none"});var a={module:"app",action:"cart",app:"modify_attribute",cart_id:this.shopping_id,attribute_id:this.haveSkuBean.cid};this.$req.post({data:a}).then((function(i){var s=i.code,a=i.message;200==s?(e.$refs.attrModal1._mask_false(),e.tj_page=1,e._axios()):t.showToast({title:a,icon:"none"})}))}else t.showToast({title:this.language.shoppingCart.chooseAttrTips,duration:1e3,icon:"none"})},_axios:function(){var i=this;this.load||t.showLoading({title:this.language.showLoading.waiting});var e={module:"app",action:"cart",app:"index",cart_id:this.$store.state.nCart,page:this.tj_page};this.$req.post({data:e}).then((function(e){i.load||t.hideLoading();var s,r=e.code,n=e.data,o=e.list,h=e.mch_list,l=e.login_status,c=(e.message,e.grade);(i.is_grade=0!=c,i.access_id1=0!=l,200==r)?(i.selectArray=[],i.selectStore=[],i.selectStoreArray=[],i.storeArray=[],i.selectAll=!1,i.display_img1=[],i.display_img=[],1==i.tj_page&&(i.list=[]),o.filter((function(t){t.vip_price=Number(t.vip_price).toFixed(2),t.vip_yprice=Number(t.vip_yprice).toFixed(2)})),(s=i.list).push.apply(s,a(o)),o.length>0?i.loadingType=0:i.loadingType=2,i.goods=n,i.mch_list=h,i._cartAllNum(),i._productDividedByStore()):(i.access_id1=!1,i.goods=[]);i.load=!0}))}},(0,s.mapMutations)({cart_id:"SET_CART_ID",pro_id:"SET_PRO_ID",order_id:"SET_ORDER_ID",address_id:"SET_ADDRESS_ID",cart_num:"SET_CART_NUM"})),{},{_reduce:function(i,e){this.goods[i].num;if(this.goods[i].num<=1)return this.goods[i].num=1,t.showToast({title:this.language.shoppingCart.reduceNo,duration:1e3,icon:"none"}),!1;this.goods[i].num--,this._munajax(this.goods[i].num,e),this._cartAllNum()},_add:function(i,e,s){var a=this.num?this.num:e;Number(this.goods[i].num)<Number(a)?(this.goods[i].num++,this._munajax(this.goods[i].num,s),this.jia_img=!0,this._cartAllNum()):(this.jia_img=!1,t.showToast({title:this.language.shoppingCart.addNo,duration:1e3,icon:"none"}))},in_array:function(t,i){for(var e=0;e<i.length;e++){var s=i[e].toString();if(s==t)return!0}return!1},_munajax:function(t,i){var e={num:t,cart_id:Number(i)},s={module:"app",action:"cart",app:"up_cart",goods:JSON.stringify(e)};this.$req.post({data:s}).then((function(t){}))},_manage:function(){this.manage=!this.manage,this.manage?(this.manage_text="编辑",this.manage_pay="去结算"):(this.manage_text="完成",this.manage_pay="删除商品")},_mask_value:function(i){var e=this;t.showTabBar(),this.mask_value=i;for(var s=[],a="",r=0;r<this.selectArray.length;r++)s.push(Number(this.selectArray[r].id)),a=a+Number(this.selectArray[r].id)+",";if("取消"==i)this.display=!1;else if("删除商品"==this.manage_pay&&"确认"==this.mask_value){var n={module:"app",action:"cart",app:"delcart"};n["cart_id"]=s,this.display_img1=[],this.$req.post({data:n}).then((function(i){200!=i.code&&t.showToast({title:i.err,duration:1500,icon:"none"}),e.manage_text="编辑",e.manage_pay="去结算",e.manage=!0,e.selectAll=!1,e.selectArray=[];for(var a=0;a<e.goods.length;a++)e.$set(e.display_img,a,!1);for(a=0;a<s.length;a++){var r=e.$store.state.nCart.indexOf(s[a]);r>-1&&e.$store.state.nCart.splice(r,1)}e.display=!1,e._axios(),e._cartAllNum()}))}},_delete:function(){var i=this;"删除商品"==this.manage_pay&&this.selectArray.length>0?(this.display=!0,t.hideTabBar()):"删除商品"==this.manage_pay&&t.showToast({title:this.language.shoppingCart.chooseDelPro,duration:1e3,icon:"none"}),"去结算"==this.manage_pay&&this.selectArray.length>0?this.isLogin((function(){for(var e=[],s=[],a=0;a<i.selectArray.length;a++)e.push(i.selectArray[a].id),s.push({num:i.selectArray[a].num,cart_id:Number(i.selectArray[a].id)});var r={module:"app",action:"cart",app:"up_cart",goods:JSON.stringify(s)};i.$req.post({data:r}).then((function(s){404!=s.code?200==s.code?(i.$store.state.cart_id=e,i.cart_id(e),i.order_id(""),i.address_id(""),t.navigateTo({url:"/pages/pay/orderDetailsrthe?cart_id="+e+"&canshu=true&returnR=1"})):(t.showToast({title:i.language.shoppingCart.kucunTips,icon:"none",duration:1e3}),setTimeout((function(){i._axios();for(var t=0;t<i.goods.length;t++)i.display_img[t]=!1;i.selectArray=[]}),1e3),i.selectAll=!1):t.showToast({title:i.language.shoppingCart.payFail,icon:"none",duration:1e3})}))})):"去结算"==this.manage_pay&&t.showToast({title:this.language.shoppingCart.choosePayPro,duration:1e3,icon:"none"})},_checkedOne:function(i,e,s,a){var r=this.selectArray.findIndex((function(t){return t.id==i.id}));if("删除商品"==this.manage_pay)if(r<0)this.selectArray.push(i),this.$set(this.display_img,e,!0);else{var n=this.selectArray.findIndex((function(t){return t.id==i.id}));this.selectArray.splice(n,1),this.$set(this.display_img,e,!1)}else if("去结算"==this.manage_pay)if(r<0&&i.stock>0)this.selectArray.push(i),this.$set(this.display_img,e,!0);else if(r>=0&&i.stock>0){n=this.selectArray.findIndex((function(t){return t.id==i.id}));this.selectArray.splice(n,1),this.$set(this.display_img,e,!1)}else t.showToast({title:this.language.shoppingCart.prokucunTips,duration:1e3,icon:"none"});if(this.selectArray.length==this.goods.length?this.selectAll=!0:this.selectAll=!1,i.mch_id==s.id){this.selectStoreArray[a]||(this.selectStoreArray[a]=[]);var o=this.selectStoreArray[a].findIndex((function(t){return t.id==i.id}));if(o<0)this.selectStoreArray[a].push(i);else{n=this.selectStoreArray[a].findIndex((function(t){return t.id==i.id}));this.selectStoreArray[a].splice(n,1)}var h=this.selectStore.findIndex((function(t){return t.id==s.id}));if(this.selectStoreArray[a].length==this.storeArray[a].children.length)h<0&&(this.$set(this.display_img1,a,!0),this.selectStore.push(s));else if(h>=0){this.$set(this.display_img1,a,!1);n=this.selectStore.findIndex((function(t){return t.id==s.id}));this.selectStore.splice(n,1)}}},_selectAll:function(){for(var i=[],e=0;e<this.goods.length;e++)this.goods[e].stock>0&&i.push(1);if("删除商品"==this.manage_pay)if(this.selectAll=!this.selectAll,this.selectAll){for(e=0;e<this.goods.length;e++)this.$set(this.selectArray,e,this.goods[e]),this.$set(this.display_img,e,!0);if(this.mch_list)for(e=0;e<this.mch_list.length;e++)if(this.$set(this.selectStore,e,this.mch_list[e]),this.$set(this.display_img1,e,!0),this.storeArray.children&&this.storeArray[e].children)for(var s=0;s<this.storeArray[e].children.length;s++)this.selectStoreArray[e]||(this.selectStoreArray[e]=[]),this.$set(this.selectStoreArray[e],s,this.storeArray[e].children[s])}else{this.selectArray=[];for(e=0;e<this.goods.length;e++)this.$set(this.display_img,e,!1);if(this.selectStore=[],this.selectStoreArray=[],this.storeArray)for(e=0;e<this.storeArray.length;e++)this.$set(this.display_img1,e,!1)}else if("去结算"==this.manage_pay)if(i.length==this.goods.length)if(this.selectAll=!this.selectAll,this.selectAll){for(e=0;e<this.goods.length;e++)this.$set(this.selectArray,e,this.goods[e]),this.$set(this.display_img,e,!0);if(this.mch_list)for(e=0;e<this.mch_list.length;e++)if(this.$set(this.selectStore,e,this.mch_list[e]),this.$set(this.display_img1,e,!0),this.storeArray[e].children)for(s=0;s<this.storeArray[e].children.length;s++)this.selectStoreArray[e]||(this.selectStoreArray[e]=[]),this.$set(this.selectStoreArray[e],s,this.storeArray[e].children[s])}else{this.selectArray=[];for(e=0;e<this.goods.length;e++)this.$set(this.display_img,e,!1);if(this.selectStore=[],this.selectStoreArray=[],this.storeArray)for(e=0;e<this.storeArray.length;e++)this.$set(this.display_img1,e,!1)}else t.showToast({title:this.language.shoppingCart.prokucunTips1,duration:1e3,icon:"none"})},_selectAllStore:function(t,i){var e=this,s=this.mch_list[i].id,a=this.selectStore.findIndex((function(t){return t.id==s}));if(a<0){for(var r=0;r<this.goods.length;r++){var n=this.selectArray.findIndex((function(t){return t.id==e.goods[r].id}));s==this.goods[r].mch_id&&n<0&&(this.selectArray.push(this.goods[r]),this.$set(this.display_img,r,!0),this.selectStoreArray[i]||(this.selectStoreArray[i]=[]),this.selectStoreArray[i].push(this.goods[r]))}this.selectStore.push(t),this.$set(this.display_img1,i,!0)}else{for(r=0;r<this.goods.length;r++){n=this.selectArray.findIndex((function(t){return t.id===e.goods[r].id}));if(s==this.goods[r].mch_id&&n>=0){this.selectArray.splice(n,1),this.$set(this.display_img,r,!1),this.selectStoreArray[i]||(this.selectStoreArray[i]=[]);var o=this.selectStoreArray[i].findIndex((function(t){return t.id===e.goods[r].id}));this.selectStoreArray.splice(o,1)}}var h=this.selectStore.findIndex((function(i){return i.id===t.id}));this.selectStore.splice(h,1),this.$set(this.display_img1,i,!1)}this.selectArray.length==this.goods.length?this.selectAll=!0:this.selectAll=!1},_productDividedByStore:function(){var t=this;if(this.mch_list&&this.goods)for(var i=0;i<this.mch_list.length;i++){this.storeArray[i]||(this.storeArray[i]=[]),this.storeArray[i].push(this.mch_list[i]),this.storeArray[i].children||(this.storeArray[i].children=[]);for(var e=0;e<this.goods.length;e++)if(this.mch_list[i].id==this.goods[e].mch_id){var s=this.storeArray[i].children.findIndex((function(i){return i.id==t.goods[e].id}));s<0&&this.storeArray[i].children.push(this.goods[e])}}},_goodsDetailed:function(i){this.pro_id(i),t.navigateTo({url:"/pages/goods/goodsDetailed?toback=true&pro_id="+i})},_cartAllNum:function(){var i=this.goods;if(i&&i.length){for(var e=0,s=0;s<i.length;s++)e+=Number(i[s].num);this.cart_num(e)}else 0==i.length&&this.cart_num(0);if(this._cart_num){var a=String(this._cart_num);t.setTabBarBadge({index:2,text:a})}else t.removeTabBarBadge({index:2})}}),computed:u({count:function(){for(var t=0,i=0;i<this.selectArray.length;i++)t+=Number(this.selectArray[i].num);return t},h5Height:function(){var t;return t="0upx",t},paddingBottom:function(){var i=0;return i=0,t.upx2px(i)+"px"},total:function(){for(var t=0,i=0;i<this.selectArray.length;i++)this.selectArray[i]&&(t+=new Number(this.selectArray[i].price)*parseInt(this.selectArray[i].num));return t.toFixed(2)}},(0,s.mapState)({_cart_num:"cart_num"}))};i.default=p}).call(this,e("543d")["default"])},"9fc5":function(t,i,e){"use strict";var s;e.d(i,"b",(function(){return a})),e.d(i,"c",(function(){return r})),e.d(i,"a",(function(){return s}));var a=function(){var t=this,i=t.$createElement;t._self._c},r=[]},c329:function(t,i,e){},c3b0:function(t,i,e){"use strict";e.r(i);var s=e("9fc5"),a=e("d272");for(var r in a)"default"!==r&&function(t){e.d(i,t,(function(){return a[t]}))}(r);e("0e81");var n,o=e("f0c5"),h=Object(o["a"])(a["default"],s["b"],s["c"],!1,null,"0a89b152",null,!1,s["a"],n);i["default"]=h.exports},d272:function(t,i,e){"use strict";e.r(i);var s=e("86c7"),a=e.n(s);for(var r in s)"default"!==r&&function(t){e.d(i,t,(function(){return s[t]}))}(r);i["default"]=a.a}},[["516b","common/runtime","common/vendor"]]]);