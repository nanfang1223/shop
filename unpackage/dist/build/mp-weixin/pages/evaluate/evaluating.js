(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/evaluate/evaluating"],{"090d":function(t,e,a){},1798:function(t,e,a){"use strict";var n=a("090d"),i=a.n(n);i.a},"21fa":function(t,e,a){"use strict";a.r(e);var n=a("255c"),i=a("e8bf");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("1798");var s,o=a("f0c5"),u=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"4d00fa1d",null,!1,n["a"],s);e["default"]=u.exports},"255c":function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement;t._self._c},r=[]},"2d1e":function(t,e,a){"use strict";(function(t){a("1fd4");n(a("66fd"));var e=n(a("21fa"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"9cc2":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var a;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=s(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,u=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return o=t.done,t},e:function(t){u=!0,r=t},f:function(){try{o||null==a.return||a.return()}finally{if(u)throw r}}}}function s(t,e){if(t){if("string"===typeof t)return o(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function u(t,e,a,n,i,r,s){try{var o=t[r](s),u=o.value}catch(c){return void a(c)}o.done?e(u):Promise.resolve(u).then(n,i)}function c(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function s(t){u(r,n,i,s,o,"next",t)}function o(t){u(r,n,i,s,o,"throw",t)}s(void 0)}))}}var d={data:function(){return{num:"",aaa:[9,8,7,6,5,4,3,2,1,0],title:"发布评价",order_details_id:"",goods:[],goodsId:[],desc:[],flag:[],index:"",stars:[],starnum:"",delete_img:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon1/delete2x.png",xiangji_img:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon1/xiangji2x.png",starOffImg:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon1/xing12x.png",starOnImg:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon1/xing22x.png?v="+Math.random(),anonymous:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon1/gou2x.png",onanonymous:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"images/icon/94661f89895ca9ab42b080e14c49c56.png",mous:!0,data:[],imgsrc:"",show:!1,timeout:"",img_index:-1,requestTime:0,requestTime1:0,resImg:[],add:"",fastTap:!0,combotab:!1,staus:!0,show_zz:!1,is_show:!0}},onLoad:function(t){this.order_details_id=t.order_details_id,this.add=t.add,this.num=t.num,this.getEvaluatingData()},onShow:function(){this.add?(this.title=this.language.evaluate.evaluating.Additional,this.is_show=!1):this.title=this.language.evaluate.evaluating.title,this.isLogin((function(){}))},onReady:function(t){"追加评价"==this.title||"Additional evaluation"==this.title?this.title=this.language.evaluate.evaluating.Additional:this.title=this.language.evaluate.evaluating.title},computed:{remnant:function(){for(var t=[],e=0;e<this.desc.length;e++)t[e]=200-this.desc[e].length;return t}},methods:{changeLoginStatus:function(){this.getEvaluatingData()},_previewImg:function(e,a){t.previewImage({current:this.data[e].src[a],urls:this.data[e].src})},getEvaluatingData:function(){var e=this,a={module:"app",action:"product",app:"comment",order_details_id:this.order_details_id,num:this.num};this.add&&(a.type=1),this.$req.post({data:a}).then((function(a){if(200==a.code){e.goods=a.commentList,e.starnum=e.goods.length;var n=[];if(e.stars.length>0)e.stars=[];else if(e.flag.length>0)e.flag=[];else for(var i=0;i<e.goods.length;i++){e.flag.push(!1);for(var r=0;r<5;r++)n.push({show:!1});e.stars.push(n),e.data.push(new Object),n=[],e.data[i].commodityId=e.goods[i].commodityId,e.data[i].size=e.goods[i].size,e.data[i].attribute_id=e.goods[i].sid,e.data[i].cid="",e.data[i].index="",e.$set(e.data[i],"src",[]),e.$set(e.data[i],"base64_img",[])}}else t.showToast({title:a.data.message,duration:1500,icon:"none"})}))},rating:function(t,e,a){var n=0,i=this.stars[t].length;++e;while(n<i)this.stars[t][n].show=n<e,n++;this.data[t].starnum=e},_mous:function(){this.mous=!this.mous},submit:function(){var e=this;return c(n.default.mark((function a(){var i,r,s,o,u,c,d,l,f;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.combotab){a.next=4;break}return a.abrupt("return",!1);case 4:e.combotab=!0,setTimeout((function(){e.combotab=!1}),2e3);case 6:e.fastTap=!1,i=0;case 8:if(!(i<e.data.length)){a.next=19;break}if(!(0==e.desc.length||""==e.desc[i]||e.desc.length<e.data.length)){a.next=15;break}return t.showToast({title:e.language.evaluate.evaluating.shop_evaluate,duration:1500,icon:"none"}),e.fastTap=!0,a.abrupt("return");case 15:e.fastTap=!1;case 16:i++,a.next=8;break;case 19:if("追加评价"==e.title&&"Additional evaluation"==e.title){a.next=32;break}r=0;case 21:if(!(r<e.data.length)){a.next=32;break}if(e.data[r].starnum||e.add){a.next=28;break}return t.showToast({title:e.language.evaluate.evaluating.shop_evaluate,duration:1500,icon:"none"}),e.fastTap=!0,a.abrupt("return",!1);case 28:e.fastTap=!0;case 29:r++,a.next=21;break;case 32:for(s=0;s<e.goods.length;s++)e.data[s].content=e.resImg[s];for(e.requestTime1=0,o=0;o<e.goods.length;o++)for(u=0;u<e.data[o].src.length;u++)e.requestTime1+=1;if(t.showLoading({title:e.language.evaluate.evaluating.Loading}),e.show_zz=!0,!e.add){a.next=41;break}for(c=0;c<e.goods.length;c++)0==e.requestTime1?(d={comment:e.desc[c],start:e.data[c].starnum,module:"app",action:"product",app:"t_comment",anonymous:e.mous?0:1,order_details_id:e.order_details_id,goodsId:e.data[c].commodityId,attributeId:e.data[c].attribute_id,type:"1",num:e.num},e.$req.post({data:d}).then((function(a){var n=a.code,i=a.message;200==n?(t.showToast({title:e.language.evaluate.evaluating.Submit_success,icon:"none",duration:1e3}),setTimeout((function(){t.redirectTo({url:"evaluatEnd"}),e.fastTap=!0}),1e3),e.show_zz=!1):(t.showToast({title:i,icon:"none",duration:1e3}),e.show_zz=!1,e.fastTap=!0)})).catch((function(t){e.fastTap=!0}))):e._Timg(c);a.next=52;break;case 41:l=0;case 42:if(!(l<e.goods.length)){a.next=52;break}if(f={comment:e.desc[l],start:e.data[l].starnum,module:"app",action:"product",app:"add_comment",anonymous:e.mous?0:1,order_details_id:e.order_details_id,goodsId:e.data[l].commodityId,attributeId:e.data[l].attribute_id,num:e.num},!e.staus){a.next=48;break}return a.next=47,e._Submission(l,f);case 47:f=a.sent;case 48:l+1==e.data.length&&t.hideLoading();case 49:l++,a.next=42;break;case 52:case"end":return a.stop()}}),a)})))()},_Submission:function(e,a){var i=this;return c(n.default.mark((function r(){var s,o;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,s=i,n.next=4,i.$req.post({data:a});case 4:o=n.sent,200==o.code?(s.data[e].cid=o.cid,0==s.data[e].src.length?(t.showToast({title:i.language.evaluate.evaluating.Submit_success,icon:"none",duration:1500}),setTimeout((function(){s.fastTap=!0,t.redirectTo({url:"evaluatEnd"})}),1500)):s._img(e)):200!=o.code&&(s.fastTap=!0,t.showToast({title:o.message,icon:"none",duration:1e3})),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),s.fastTap=!0;case 11:case"end":return n.stop()}}),r,null,[[0,8]])})))()},_img:function(t){var e=this;return c(n.default.mark((function a(){var i,r,s;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i=e,r=0;case 2:if(!(r<i.data[t].src.length)){a.next=11;break}return s={access_id:i.access_id,module:"app",action:"product",app:"img_comment",cid:i.data[t].cid,upload_z_num:i.data[t].src.length,upload_num:r},s.store_type=1,a.next=7,e._upload(t,r,s);case 7:s=a.sent;case 8:r++,a.next=2;break;case 11:case"end":return a.stop()}}),a)})))()},_upload:function(e,a,n){var i=this;return new Promise((function(r){t.uploadFile({url:t.getStorageSync("url"),filePath:i.data[e].src[a],name:"file",formData:n,success:function(n){var s=JSON.parse(n.data);i.fastTap=!0,200==s.code?(a++,a==i.data[e].src.length&&i.data.length-e==1?(i.fastTap=!0,i.staus=!1,t.showToast({title:i.language.evaluate.evaluating.Submit_success,duration:1500,icon:"none"}),setTimeout((function(){t.navigateBack({delta:1})}),1500)):i.staus=!0,r(s)):t.showToast({title:s.status,duration:1500,icon:"none"})},error:function(){i.fastTap=!0}})}))},_Timg:function(t){var e=this;return c(n.default.mark((function a(){var i,r,s;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i=e,r=0;case 2:if(!(r<i.data[t].src.length)){a.next=11;break}return s={access_id:i.access_id,module:"app",action:"product",app:"t_comment",anonymous:i.mous?0:1,order_details_id:i.order_details_id,start:i.data[t].starnum,comment:i.desc[t],goodsId:i.data[t].commodityId,attributeId:i.data[t].attribute_id,upload_z_num:i.data[t].src.length,upload_num:r},s.store_type=1,a.next=7,e._upload(t,r,s);case 7:s=a.sent;case 8:r++,a.next=2;break;case 11:case"end":return a.stop()}}),a)})))()},choiceImg:function(e,a){var i=this,r=Number(this.aaa[a]);t.chooseImage({count:r,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(){var t=c(n.default.mark((function t(a){var r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.getImageList(a.tempFilePaths);case 2:r=t.sent,i.resImg=i.resImg.concat(r),i.data[e].src=i.data[e].src.concat(r);case 5:case"end":return t.stop()}}),t)})));function a(e){return t.apply(this,arguments)}return a}()})},getImageList:function(e){return c(n.default.mark((function a(){var i,s,o,u,c;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i=e,s=r(i.keys()),a.prev=2,s.s();case 4:if((o=s.n()).done){a.next=12;break}return u=o.value,a.next=8,t.getImageInfo({src:i[u]});case 8:c=a.sent,i[u]=c[1].path;case 10:a.next=4;break;case 12:a.next=17;break;case 14:a.prev=14,a.t0=a["catch"](2),s.e(a.t0);case 17:return a.prev=17,s.f(),a.finish(17);case 20:return a.abrupt("return",Promise.resolve(i));case 21:case"end":return a.stop()}}),a,null,[[2,14,17,20]])})))()},_delete:function(t,e){this.data[t].src.length>0&&(this.data[t].src.splice(e,1),this.resImg.splice(e,1))}}};e.default=d}).call(this,a("543d")["default"])},e8bf:function(t,e,a){"use strict";a.r(e);var n=a("9cc2"),i=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a}},[["2d1e","common/runtime","common/vendor"]]]);